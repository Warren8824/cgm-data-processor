
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>xDrip+ Data Analysis for Gastroparesis Screening (XGastro-EDA) &#8212; Gastro_eda_book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster.custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster.bundle.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster-sideTip-shadow.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster-sideTip-punk.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster-sideTip-noir.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster-sideTip-light.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster-sideTip-borderless.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/micromodal.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../_static/js/hoverxref.js"></script>
    <script src="../_static/js/tooltipster.bundle.min.js"></script>
    <script src="../_static/js/micromodal.min.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/x_gastro_eda';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Welcome to My Jupyter Book!" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Gastro_eda_book - Home"/>
    <img src="../_static/logo.png" class="logo__image only-dark pst-js-only" alt="Gastro_eda_book - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to My Jupyter Book!
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">xDrip+ Data Analysis for Gastroparesis Screening (XGastro-EDA)</a></li>
























</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/Warren8824/cgm-data-processor" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/Warren8824/cgm-data-processor/issues/new?title=Issue%20on%20page%20%2Fcontent/x_gastro_eda.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/content/x_gastro_eda.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>xDrip+ Data Analysis for Gastroparesis Screening (XGastro-EDA)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">xDrip+ Data Analysis for Gastroparesis Screening (XGastro-EDA)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#project-context">Project Context</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-source">Data Source</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#project-objectives">Project Objectives</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#notebook-structure">Notebook Structure</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#required-libraries-and-dependencies">Required Libraries and Dependencies</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#import-our-created-functions">Import our created functions</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-source-xdrip-sqlite-database">Data Source: xDrip+ SQLite Database</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#database-connection">Database Connection</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-and-initial-data-processing">Loading and Initial Data Processing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-loading-process">Data Loading Process</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#treatment-data-preprocessing-insulin-classification">Treatment Data Preprocessing: Insulin Classification</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#classification-rules">Classification Rules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#function-process">Function Process</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#analysing-insulin-usage-patterns-over-time">Analysing Insulin Usage Patterns Over Time</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-components">Analysis Components</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualisation">Visualisation</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-validation-raw-insulin-distribution">Data Validation: Raw Insulin Distribution</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#refined-insulin-dataset-structure">Refined Insulin Dataset Structure</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#carbohydrate-data-preprocessing">Carbohydrate Data Preprocessing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rationale">Rationale</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#refined-carbohydrate-dataset-structure">Refined Carbohydrate Dataset Structure</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#visual-validation-carbohydrate-distribution">Visual Validation: Carbohydrate Distribution</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#carbohydrate-dataset-summary">Carbohydrate Dataset Summary</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#blood-glucose-data-preprocessing">Blood Glucose Data Preprocessing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cleaning-steps">Cleaning Steps</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Rationale</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#blood-glucose-data-visualization">Blood Glucose Data Visualization</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#full-dataset-scatter-plot">Full Dataset Scatter Plot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recent-90-day-time-series">Recent 90-Day Time Series</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recent-48-hour-time-series">Recent 48-Hour Time Series</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-overview-final-check">Dataset Overview: Final Check</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-alignment-and-synthesis">Data Alignment and Synthesis</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alignment-process">Alignment Process</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#glucose-data-gap-analysis">Glucose Data Gap Analysis</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gap-detection-process">Gap Detection Process</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#key-outputs">Key Outputs</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#glucose-monitoring-gap-analysis-results">Glucose Monitoring Gap Analysis Results</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview-of-data-gaps">Overview of Data Gaps</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gap-distribution">Gap Distribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#critical-observations">Critical Observations</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#meal-analysis-configuration-and-quality-assessment">Meal Analysis Configuration and Quality Assessment</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-quality-framework">Data Quality Framework</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-categories">Quality Categories</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration-parameters">Configuration Parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#processing-workflow">Processing Workflow</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#meal-quality-statistics-generation">Meal Quality Statistics Generation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generated-statistics">Generated Statistics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-output-format">Statistical Output Format</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#meal-quality-dashboard-generation">Meal Quality Dashboard Generation</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#meal-analysis-results-summary">Meal Analysis Results Summary</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-overview">Dataset Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-distribution">Quality Distribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-quality-metrics">Data Quality Metrics</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-structure-and-statistical-summary">Dataset Structure and Statistical Summary</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-properties-analysis">Dataset Properties Analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-structure">Data Structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-distribution">Statistical Distribution</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#diabetes-data-processing-and-meal-analysis-summary">Diabetes Data Processing and Meal Analysis Summary</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-data-processing">Initial Data Processing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-alignment-and-quality-analysis">Data Alignment and Quality Analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-metrics-and-results">Quality Metrics and Results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#new-dataset-features">New Dataset Features</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#important-notes">Important Notes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#next-steps">Next Steps</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="xdrip-data-analysis-for-gastroparesis-screening-xgastro-eda">
<h1>xDrip+ Data Analysis for Gastroparesis Screening (XGastro-EDA)<a class="headerlink" href="#xdrip-data-analysis-for-gastroparesis-screening-xgastro-eda" title="Link to this heading">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>This notebook demonstrates the processing and analysis of Continuous Glucose Monitoring (CGM) data from xDrip+ for potential gastroparesis screening applications. By carefully processing CGM data alongside meal and insulin records, we create a foundation for analyzing post-meal glucose response patterns.</p>
<section id="project-context">
<h3>Project Context<a class="headerlink" href="#project-context" title="Link to this heading">#</a></h3>
<p>Gastroparesis, a condition affecting gastric emptying, can be challenging to diagnose. Traditional screening methods often require specialized testing. This project explores the potential of using readily available CGM data to identify patterns that might indicate delayed gastric emptying.</p>
</section>
<section id="data-source">
<h3>Data Source<a class="headerlink" href="#data-source" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>xDrip+</strong>: An open-source diabetes management application</p></li>
<li><p><strong>Time Period</strong>: June 2023 - September 2024</p></li>
<li><p><strong>Key Components</strong>:</p></li>
</ul>
<ul class="simple">
<li><p>CGM readings at 5-minute intervals</p></li>
<li><p>Meal records with carbohydrate quantities</p></li>
<li><p>Insulin dosing (basal and bolus)</p></li>
</ul>
</section>
<section id="project-objectives">
<h3>Project Objectives<a class="headerlink" href="#project-objectives" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Data Integration</strong></p></li>
</ol>
<ul class="simple">
<li><p>Align CGM, meal, and insulin data to common timeline</p></li>
<li><p>Ensure data quality and completeness</p></li>
<li><p>Create robust meal analysis framework</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p><strong>Quality Assurance</strong></p></li>
</ol>
<ul class="simple">
<li><p>Identify and characterize data gaps</p></li>
<li><p>Implement appropriate interpolation strategies</p></li>
<li><p>Maintain data integrity for clinical analysis</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p><strong>Analysis Preparation</strong></p></li>
</ol>
<ul class="simple">
<li><p>Focus on significant meals (&gt;20g carbs)</p></li>
<li><p>Create 4-hour post-meal analysis windows</p></li>
<li><p>Develop quality metrics for meal data assessment</p></li>
</ul>
</section>
<section id="notebook-structure">
<h3>Notebook Structure<a class="headerlink" href="#notebook-structure" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Data extraction and cleaning</p></li>
<li><p>Timeline alignment and gap analysis</p></li>
<li><p>Meal period identification and classification</p></li>
<li><p>Quality assessment and interpolation</p></li>
<li><p>Statistical validation</p></li>
<li><p>Preparation for further analysis</p></li>
</ol>
<p>This notebook focuses on data preparation and quality assessment, laying the groundwork for subsequent analysis of post-meal glucose patterns.</p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="required-libraries-and-dependencies">
<h1>Required Libraries and Dependencies<a class="headerlink" href="#required-libraries-and-dependencies" title="Link to this heading">#</a></h1>
<p>This notebook uses several Python libraries for data manipulation, analysis, and visualization:</p>
<ul class="simple">
<li><p><strong>pandas</strong>: Core data manipulation and analysis</p></li>
<li><p><strong>numpy</strong>: Numerical operations and array handling (imported in respective module)</p></li>
<li><p><strong>matplotlib</strong>: Data visualization and plotting</p></li>
<li><p><strong>sqlalchemy</strong>: Database connectivity and operations</p></li>
<li><p><strong>ast</strong>: Safe parsing of JSON-like strings (imported in respective module)</p></li>
<li><p><strong>enum, dataclass, typing</strong>: Type hinting and structured data classes (imported in respective module)</p></li>
<li><p><strong>display</strong>: Improved print options in Jupyter</p></li>
<li><p><strong>pprint</strong>: Improved print layout of nested data structures</p></li>
</ul>
<p>Note: This project assumes you have these libraries installed. If needed, install via pip:
<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">pandas</span> <span class="pre">numpy</span> <span class="pre">matplotlib</span> <span class="pre">sqlalchemy</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span><span class="p">,</span> <span class="n">Image</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;&lt;style&gt;.container { width:95% !important; }&lt;/style&gt;&quot;</span><span class="p">))</span> <span class="c1"># Make Jupyter cells wider for better visuals</span>
<span class="kn">import</span> <span class="nn">pprint</span>
</pre></div>
</div>
<style>.container { width:95% !important; }</style>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="import-our-created-functions">
<h1>Import our created functions<a class="headerlink" href="#import-our-created-functions" title="Link to this heading">#</a></h1>
<p>We have chosen to keep the main code functionality seperate from this notebook for a couple of reasons, one being they keep our functionality modular, this is an advantage for multiple reasons including future use in other proejcts with minimal modifications. Other reasons being to keep the length of the notebook down and visually appealing as possible. This method will also allow for the repo to be cloned and used within your own projects, creating a tool for importing cleaning and using with your own data, in your own specific way and allowing for future expansion for other CGM device and data formats.</p>
<p>If you have an interest, all our python code can be found in our <code class="docutils literal notranslate"><span class="pre">src</span></code> directory, and we have implemented this jupyter book with hover tooltip functionality, this will show the linked python code for each function as the are being used by simply hovering over the link in the markdown cell prior to the function use. the functions will be shown in links using this format: Here’s a function from</p>
<p><a class="reference download internal" download="" href="../_downloads/2b5a3139da501f92b4ec41b3989efd92/my_module.py"><span class="xref download myst"><code class="docutils literal notranslate"><span class="pre">my_module.py</span></code></span></a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Path modification used to allow Notebook access to src directory</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">notebook_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">project_root</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">notebook_path</span><span class="p">,</span> <span class="s1">&#39;../../&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">project_root</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">:</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">project_root</span><span class="p">)</span>

<span class="c1"># Preprocessing Module - Load, clean and align data</span>
<span class="kn">from</span> <span class="nn">src.preprocessing.loading</span> <span class="kn">import</span> <span class="n">XDrip</span>  
<span class="kn">from</span> <span class="nn">src.preprocessing.cleaning</span> <span class="kn">import</span> <span class="n">clean_classify_insulin</span><span class="p">,</span> <span class="n">clean_classify_carbs</span><span class="p">,</span> <span class="n">clean_glucose</span>
<span class="kn">from</span> <span class="nn">src.preprocessing.alignment</span> <span class="kn">import</span> <span class="n">align_diabetes_data</span>

<span class="c1"># Analysis Module - Check and display data quality</span>
<span class="kn">from</span> <span class="nn">src.analysis.config</span> <span class="kn">import</span> <span class="n">MealQuality</span><span class="p">,</span> <span class="n">MealAnalysisConfig</span>
<span class="kn">from</span> <span class="nn">src.analysis.gaps</span> <span class="kn">import</span> <span class="n">analyse_glucose_gaps</span>
<span class="kn">from</span> <span class="nn">src.analysis.insulin</span> <span class="kn">import</span> <span class="n">analyse_insulin_over_time</span>
<span class="kn">from</span> <span class="nn">src.analysis.meals</span> <span class="kn">import</span> <span class="n">analyse_meal_data</span><span class="p">,</span> <span class="n">get_meal_statistics</span>
<span class="kn">from</span> <span class="nn">src.analysis.metrics</span> <span class="kn">import</span> <span class="n">display_quality_metrics</span>

<span class="c1"># Visualisation Module - Format data for visual appeal in Jupyter</span>
<span class="kn">from</span> <span class="nn">src.visualisation.quality_dashboard</span> <span class="kn">import</span> <span class="n">create_quality_dashboard</span>
<span class="kn">from</span> <span class="nn">src.visualisation.meal_statistics_dashboard</span> <span class="kn">import</span> <span class="n">create_meal_statistics_dashboard</span>
<span class="kn">from</span> <span class="nn">src.visualisation.gap_dashboard</span> <span class="kn">import</span> <span class="n">create_gap_dashboard</span>
</pre></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="data-source-xdrip-sqlite-database">
<h1>Data Source: xDrip+ SQLite Database<a class="headerlink" href="#data-source-xdrip-sqlite-database" title="Link to this heading">#</a></h1>
<p>This notebook begins by connecting to an xDrip+ SQLite database export. xDrip+ is an open-source diabetes management application that stores various diabetes-related data including glucose readings, treatments, and device status information.</p>
<section id="database-connection">
<h2>Database Connection<a class="headerlink" href="#database-connection" title="Link to this heading">#</a></h2>
<p>We establish a connection to the SQLite database and inspect its structure. The database contains 29 tables storing different aspects of diabetes management data:</p>
<p>Key tables for our analysis:</p>
<ul class="simple">
<li><p><strong>BgReadings</strong>: Continuous glucose monitoring (CGM) data</p></li>
<li><p><strong>Treatments</strong>: Insulin doses and carbohydrate intake records</p></li>
<li><p><strong>Calibration</strong>: Sensor calibration events</p></li>
<li><p><strong>Sensors</strong>: CGM sensor information</p></li>
</ul>
<p><a class="reference download internal" download="" href="../_downloads/54180d10a1bb07dba3417962131df820/loading.py"><span class="xref download myst"><code class="docutils literal notranslate"><span class="pre">XDrip</span></code></span></a>
<a class="reference download internal" download="" href="../_downloads/54180d10a1bb07dba3417962131df820/loading.py"><span class="xref download myst"><code class="docutils literal notranslate"><span class="pre">get_table_names()</span></code></span></a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Path to your SQLite file</span>
<span class="n">db_path</span> <span class="o">=</span> <span class="s1">&#39;../../data/export20240928-130349.sqlite&#39;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">XDrip</span><span class="p">(</span><span class="n">db_path</span><span class="p">)</span> <span class="c1"># Load db path into XDrip class - Class found in src directory</span>
<span class="n">tables</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_table_names</span><span class="p">()</span> <span class="c1"># PPrint all table names in sqlite file - Function found in src directory</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[&#39;APStatus&#39;,
 &#39;Accuracy&#39;,
 &#39;ActiveBgAlert&#39;,
 &#39;ActiveBluetoothDevice&#39;,
 &#39;AlertType&#39;,
 &#39;BgReadings&#39;,
 &#39;BgSendQueue&#39;,
 &#39;BloodTest&#39;,
 &#39;Calibration&#39;,
 &#39;CalibrationRequest&#39;,
 &#39;CalibrationSendQueue&#39;,
 &#39;DesertSync&#39;,
 &#39;HeartRate&#39;,
 &#39;Libre2RawValue2&#39;,
 &#39;Libre2Sensors&#39;,
 &#39;LibreBlock&#39;,
 &#39;LibreData&#39;,
 &#39;Notifications&#39;,
 &#39;PebbleMovement&#39;,
 &#39;PenData&#39;,
 &#39;Prediction&#39;,
 &#39;Reminder&#39;,
 &#39;SensorSendQueue&#39;,
 &#39;Sensors&#39;,
 &#39;TransmitterData&#39;,
 &#39;Treatments&#39;,
 &#39;UploaderQueue&#39;,
 &#39;UserErrors&#39;,
 &#39;android_metadata&#39;]
</pre></div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="loading-and-initial-data-processing">
<h1>Loading and Initial Data Processing<a class="headerlink" href="#loading-and-initial-data-processing" title="Link to this heading">#</a></h1>
<p>We extract three key datasets from the xDrip+ database and prepare them for analysis by:</p>
<ol class="arabic simple">
<li><p>Converting Unix timestamps to pandas datetime format</p></li>
<li><p>Setting timestamps as index for time-series analysis</p></li>
<li><p>Creating separate dataframes initially for:</p></li>
</ol>
<ul class="simple">
<li><p>Blood glucose readings</p></li>
<li><p>Treatment records (insulin &amp; carbohydrates)</p></li>
</ul>
<section id="data-loading-process">
<h2>Data Loading Process<a class="headerlink" href="#data-loading-process" title="Link to this heading">#</a></h2>
<p>Each table requires the same preprocessing steps:</p>
<ul class="simple">
<li><p>SQL to pandas DataFrame conversion</p></li>
<li><p>Timestamp conversion from milliseconds</p></li>
<li><p>Index creation from timestamp</p></li>
</ul>
<p>You can check out the full implementation in the src directory.
Let’s examine the structure of our blood glucose data:</p>
<p><a class="reference download internal" download="" href="../_downloads/54180d10a1bb07dba3417962131df820/loading.py"><span class="xref download myst"><code class="docutils literal notranslate"><span class="pre">load_glucose_df()</span></code></span></a>
<a class="reference download internal" download="" href="../_downloads/54180d10a1bb07dba3417962131df820/loading.py"><span class="xref download myst"><code class="docutils literal notranslate"><span class="pre">load_treatment_df()</span></code></span></a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bg_df</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">load_glucose_df</span><span class="p">()</span> <span class="c1"># Load glucose data into a pandas dataframes and set timestamp as index - Function found in src directory</span>

<span class="n">treatment_df</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">load_treatment_df</span><span class="p">()</span> <span class="c1"># Load glucose data into a pandas dataframes and set timestamp as index - Function found in src directory</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Explore the first few rows of the blood glucose table</span>
<span class="n">bg_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</pre></div>
</div>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>_id</th>
      <th>a</th>
      <th>age_adjusted_raw_value</th>
      <th>b</th>
      <th>c</th>
      <th>calculated_value</th>
      <th>calculated_value_slope</th>
      <th>calibration</th>
      <th>calibration_flag</th>
      <th>calibration_uuid</th>
      <th>...</th>
      <th>ra</th>
      <th>raw_calculated</th>
      <th>raw_data</th>
      <th>rb</th>
      <th>rc</th>
      <th>sensor</th>
      <th>sensor_uuid</th>
      <th>source_info</th>
      <th>time_since_sensor_started</th>
      <th>uuid</th>
    </tr>
    <tr>
      <th>timestamp</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2023-06-03 22:31:05.757</th>
      <td>72464</td>
      <td>1.245412e-13</td>
      <td>190.235280</td>
      <td>-0.419946</td>
      <td>3.540085e+11</td>
      <td>133.923468</td>
      <td>-0.000035</td>
      <td>559.0</td>
      <td>0</td>
      <td>cba43ee7-5a7c-47e7-beb5-a5d7c211e64b</td>
      <td>...</td>
      <td>1.620198e-13</td>
      <td>0.0</td>
      <td>190.235280</td>
      <td>-0.546322</td>
      <td>4.605416e+11</td>
      <td>42</td>
      <td>73b87f32-2b6b-47c9-b2bc-9283632d169a</td>
      <td>None</td>
      <td>1.211123e+09</td>
      <td>a63f2267-5f99-4663-8714-7146835e118c</td>
    </tr>
    <tr>
      <th>2023-06-03 22:36:06.812</th>
      <td>72465</td>
      <td>7.766019e-12</td>
      <td>178.352928</td>
      <td>-26.184433</td>
      <td>2.207130e+13</td>
      <td>124.789758</td>
      <td>-0.000030</td>
      <td>559.0</td>
      <td>0</td>
      <td>cba43ee7-5a7c-47e7-beb5-a5d7c211e64b</td>
      <td>...</td>
      <td>1.010308e-11</td>
      <td>0.0</td>
      <td>178.352928</td>
      <td>-34.064212</td>
      <td>2.871330e+13</td>
      <td>42</td>
      <td>73b87f32-2b6b-47c9-b2bc-9283632d169a</td>
      <td>None</td>
      <td>1.211424e+09</td>
      <td>d1386140-bdfe-4bd3-802e-9b406cf320c2</td>
    </tr>
    <tr>
      <th>2023-06-03 22:41:09.457</th>
      <td>72466</td>
      <td>2.847681e-11</td>
      <td>173.176458</td>
      <td>-96.014259</td>
      <td>8.093196e+13</td>
      <td>120.810715</td>
      <td>-0.000013</td>
      <td>559.0</td>
      <td>0</td>
      <td>cba43ee7-5a7c-47e7-beb5-a5d7c211e64b</td>
      <td>...</td>
      <td>3.704645e-11</td>
      <td>0.0</td>
      <td>173.176458</td>
      <td>-124.908189</td>
      <td>1.052871e+14</td>
      <td>42</td>
      <td>73b87f32-2b6b-47c9-b2bc-9283632d169a</td>
      <td>None</td>
      <td>1.211727e+09</td>
      <td>1f24e9fc-b7f5-4ae9-a5ca-2ba50b8d3e09</td>
    </tr>
    <tr>
      <th>2023-06-03 22:50:16.249</th>
      <td>72467</td>
      <td>-1.041753e-11</td>
      <td>157.529400</td>
      <td>35.124388</td>
      <td>-2.960690e+13</td>
      <td>108.783156</td>
      <td>-0.000022</td>
      <td>559.0</td>
      <td>0</td>
      <td>cba43ee7-5a7c-47e7-beb5-a5d7c211e64b</td>
      <td>...</td>
      <td>-1.355251e-11</td>
      <td>0.0</td>
      <td>157.529400</td>
      <td>45.694502</td>
      <td>-3.851661e+13</td>
      <td>42</td>
      <td>73b87f32-2b6b-47c9-b2bc-9283632d169a</td>
      <td>None</td>
      <td>1.212273e+09</td>
      <td>b6395bd2-e2fb-4471-845a-ad2f2efb5e66</td>
    </tr>
    <tr>
      <th>2023-06-03 22:55:15.702</th>
      <td>72468</td>
      <td>-3.626429e-12</td>
      <td>147.764695</td>
      <td>12.227082</td>
      <td>-1.030639e+13</td>
      <td>101.277236</td>
      <td>-0.000025</td>
      <td>559.0</td>
      <td>0</td>
      <td>cba43ee7-5a7c-47e7-beb5-a5d7c211e64b</td>
      <td>...</td>
      <td>-4.717744e-12</td>
      <td>0.0</td>
      <td>147.764695</td>
      <td>15.906624</td>
      <td>-1.340793e+13</td>
      <td>42</td>
      <td>73b87f32-2b6b-47c9-b2bc-9283632d169a</td>
      <td>None</td>
      <td>1.212573e+09</td>
      <td>3cdb52ca-e4e3-43d0-8274-f16c70c24513</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 28 columns</p>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="treatment-data-preprocessing-insulin-classification">
<h1>Treatment Data Preprocessing: Insulin Classification<a class="headerlink" href="#treatment-data-preprocessing-insulin-classification" title="Link to this heading">#</a></h1>
<p>This function implements a sophisticated insulin classification algorithm for diabetes treatment data. The classification process handles both labeled and unlabeled insulin entries, using a combination of explicit insulin types and quantity-based rules.</p>
<section id="classification-rules">
<h2>Classification Rules<a class="headerlink" href="#classification-rules" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>Labeled Insulin</strong></p></li>
</ol>
<ul class="simple">
<li><p>Novorapid → Bolus insulin</p></li>
<li><p>Levemir → Basal insulin</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p><strong>Unlabeled Insulin</strong></p></li>
</ol>
<ul>
<li><p>≤ 8 units → Classified as Bolus</p></li>
<li><p>8-15 units → Classified as Basal</p></li>
<li><blockquote>
<div><p>15 units → Dropped (likely data entry errors)</p>
</div></blockquote>
</li>
</ul>
</section>
<section id="function-process">
<h2>Function Process<a class="headerlink" href="#function-process" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Creates separate columns for bolus and basal insulin</p></li>
<li><p>Processes JSON metadata for labeled entries</p></li>
<li><p>Applies rule-based classification for unlabeled entries</p></li>
<li><p>Maintains data integrity by dropping suspicious entries</p></li>
</ul>
<p><a class="reference download internal" download="" href="../_downloads/c38b3c8b3075cfca5be297423442201d/cleaning.py"><span class="xref download myst"><code class="docutils literal notranslate"><span class="pre">clean_classify_insulin()</span></code></span></a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">insulin_df</span> <span class="o">=</span> <span class="n">clean_classify_insulin</span><span class="p">(</span><span class="n">treatment_df</span><span class="p">)</span> <span class="c1"># Function in source directory</span>
</pre></div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="analysing-insulin-usage-patterns-over-time">
<h1>Analysing Insulin Usage Patterns Over Time<a class="headerlink" href="#analysing-insulin-usage-patterns-over-time" title="Link to this heading">#</a></h1>
<p>This analysis examines the temporal patterns in insulin usage, providing insights into treatment consistency and data quality. The function performs both data analysis and visualization, helping identify trends and potential data collection issues.</p>
<section id="analysis-components">
<h2>Analysis Components<a class="headerlink" href="#analysis-components" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>Temporal Aggregation</strong></p></li>
</ol>
<ul class="simple">
<li><p>Groups data by month</p></li>
<li><p>Processes JSON metadata for insulin types</p></li>
<li><p>Calculates usage percentages for different insulin types</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p><strong>Insulin Classification</strong></p></li>
</ol>
<ul class="simple">
<li><p>Novorapid (rapid-acting insulin)</p></li>
<li><p>Levemir (long-acting insulin)</p></li>
<li><p>Other insulin types</p></li>
<li><p>Unspecified entries</p></li>
</ul>
</section>
<section id="visualisation">
<h2>Visualisation<a class="headerlink" href="#visualisation" title="Link to this heading">#</a></h2>
<p>The function generates two complementary plots:</p>
<ol class="arabic simple">
<li><p><strong>Stacked Area Chart</strong></p></li>
</ol>
<ul class="simple">
<li><p>Shows relative distribution of insulin types</p></li>
<li><p>Uses consistent color coding (Orange: Novorapid, Green: Levemir)</p></li>
<li><p>Reveals changes in recording practices</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p><strong>Entry Count Timeline</strong></p></li>
</ol>
<ul class="simple">
<li><p>Displays total monthly entries</p></li>
<li><p>Helps identify data collection gaps or inconsistencies</p></li>
</ul>
<p><a class="reference download internal" download="" href="../_downloads/c7dd1efb371602d9ad31d54a5fa009a3/insulin.py"><span class="xref download myst"><code class="docutils literal notranslate"><span class="pre">analyse_insulin_over_time()</span></code></span></a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">,</span> <span class="n">insulin_counts</span> <span class="o">=</span> <span class="n">analyse_insulin_over_time</span><span class="p">(</span><span class="n">insulin_df</span><span class="p">)</span> <span class="c1"># Function in source directory</span>
<span class="n">plot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><img alt="png" src="../_images/x_gastro_eda_14_0.png" /></p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="data-validation-raw-insulin-distribution">
<h1>Data Validation: Raw Insulin Distribution<a class="headerlink" href="#data-validation-raw-insulin-distribution" title="Link to this heading">#</a></h1>
<p>Before proceeding with our cleaned and classified insulin data, we visualize the raw insulin entries to:</p>
<ol class="arabic simple">
<li><p>Verify the range of insulin values</p></li>
<li><p>Identify potential outliers</p></li>
<li><p>Check temporal distribution of entries</p></li>
<li><p>Validate our classification thresholds (8u for bolus, 15u for basal)</p></li>
</ol>
<p>The scatter plot provides a quick visual validation that our insulin classification function’s assumptions align with the actual data patterns.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make plot 25 x 12</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">insulin_df</span><span class="p">[</span><span class="s1">&#39;insulin&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Insulin&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#F26F21&#39;</span><span class="p">)</span>

<span class="c1"># Add labels, title, and legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Timestamp&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Insulin&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><img alt="png" src="../_images/x_gastro_eda_16_0.png" /></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make plot 25 x 12</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="c1"># Create masks for NovoRapid (bolus) and Levemir (basal)</span>
<span class="n">bolus_mask</span> <span class="o">=</span> <span class="n">insulin_df</span><span class="p">[</span><span class="s1">&#39;bolus&#39;</span><span class="p">]</span> <span class="o">&gt;</span><span class="mf">0.0</span>
<span class="n">basal_mask</span> <span class="o">=</span> <span class="n">insulin_df</span><span class="p">[</span><span class="s1">&#39;basal&#39;</span><span class="p">]</span><span class="o">&gt;</span> <span class="mf">0.0</span>

<span class="c1"># Plot bolus (NovoRapid) points</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">insulin_df</span><span class="p">[</span><span class="n">bolus_mask</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">),</span>  <span class="c1"># Convert index to NumPy array</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">insulin_df</span><span class="p">[</span><span class="n">bolus_mask</span><span class="p">][</span><span class="s1">&#39;insulin&#39;</span><span class="p">]),</span>  <span class="c1"># Convert insulin values to NumPy array</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;NovoRapid (Bolus)&#39;</span><span class="p">,</span> 
    <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> 
    <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>  <span class="c1"># No line connecting points</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#F26F21&#39;</span>  <span class="c1"># NovoRapid orange</span>
<span class="p">)</span>

<span class="c1"># Plot basal (Levemir) points</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">insulin_df</span><span class="p">[</span><span class="n">basal_mask</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">),</span>  <span class="c1"># Convert index to NumPy array</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">insulin_df</span><span class="p">[</span><span class="n">basal_mask</span><span class="p">][</span><span class="s1">&#39;insulin&#39;</span><span class="p">]),</span>  <span class="c1"># Convert insulin values to NumPy array</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Levemir (Basal)&#39;</span><span class="p">,</span> 
    <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> 
    <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>  <span class="c1"># No line connecting points</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#35b57d&#39;</span>  <span class="c1"># Levemir green</span>
<span class="p">)</span>

<span class="c1"># Add labels, title, and legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Timestamp&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Insulin&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><img alt="png" src="../_images/x_gastro_eda_17_0.png" /></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="refined-insulin-dataset-structure">
<h1>Refined Insulin Dataset Structure<a class="headerlink" href="#refined-insulin-dataset-structure" title="Link to this heading">#</a></h1>
<p>After cleaning and classification, we isolate our two key insulin variables (bolus and basal) and examine the resulting dataset structure. This inspection helps:</p>
<ol class="arabic simple">
<li><p><strong>Verify Data Processing</strong></p></li>
</ol>
<ul class="simple">
<li><p>Confirm successful separation of insulin types</p></li>
<li><p>Check data types and memory usage</p></li>
<li><p>Review null values if any</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p><strong>Statistical Overview</strong></p></li>
</ol>
<ul class="simple">
<li><p>Distribution of both insulin types</p></li>
<li><p>Typical dosing ranges</p></li>
<li><p>Identify any remaining outliers</p></li>
</ul>
<p>The .info() shows our dataframe structure while .describe() provides key statistical measures.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">insulin_df</span> <span class="o">=</span> <span class="n">insulin_df</span><span class="p">[[</span><span class="s1">&#39;bolus&#39;</span><span class="p">,</span> <span class="s1">&#39;basal&#39;</span><span class="p">]]</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">insulin_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
DatetimeIndex: 4595 entries, 2023-06-03 23:58:08.909000 to 2024-09-28 09:44:00.948000
Data columns (total 2 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   bolus   4595 non-null   float64
 1   basal   4595 non-null   float64
dtypes: float64(2)
memory usage: 236.7 KB
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">insulin_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</pre></div>
</div>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bolus</th>
      <th>basal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>4595.000000</td>
      <td>4595.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>3.213036</td>
      <td>1.182372</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2.170215</td>
      <td>3.551143</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>3.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>5.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>8.000000</td>
      <td>15.000000</td>
    </tr>
  </tbody>
</table>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="carbohydrate-data-preprocessing">
<h1>Carbohydrate Data Preprocessing<a class="headerlink" href="#carbohydrate-data-preprocessing" title="Link to this heading">#</a></h1>
<p>A straightforward but essential cleaning step for carbohydrate data. This function:</p>
<ol class="arabic simple">
<li><p>Creates a safe copy of the original data</p></li>
<li><p>Removes trivial carbohydrate entries (&lt;1g)</p></li>
<li><p>Maintains original timestamp indexing</p></li>
</ol>
<section id="rationale">
<h2>Rationale<a class="headerlink" href="#rationale" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Entries below 1g are likely recording errors or insignificant for meal analysis</p></li>
<li><p>Clean dataset focuses on meaningful carbohydrate intake events</p></li>
<li><p>Preserves original data structure for later meal impact analysis</p></li>
</ul>
<p><a class="reference download internal" download="" href="../_downloads/c38b3c8b3075cfca5be297423442201d/cleaning.py"><span class="xref download myst"><code class="docutils literal notranslate"><span class="pre">clean_classify_carbs()</span></code></span></a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">carb_df</span> <span class="o">=</span> <span class="n">clean_classify_carbs</span><span class="p">(</span><span class="n">treatment_df</span><span class="p">)</span> <span class="c1"># Function in source directory</span>
</pre></div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="refined-carbohydrate-dataset-structure">
<h1>Refined Carbohydrate Dataset Structure<a class="headerlink" href="#refined-carbohydrate-dataset-structure" title="Link to this heading">#</a></h1>
<p>After cleaning our carbohydrates dataset, we simply wish to keep the index and carbs column.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drop all columns except carbohydrate</span>
<span class="n">carb_df</span> <span class="o">=</span> <span class="n">carb_df</span><span class="p">[[</span><span class="s1">&#39;carbs&#39;</span><span class="p">]]</span>
<span class="n">carb_df</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</pre></div>
</div>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carbs</th>
    </tr>
    <tr>
      <th>timestamp</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2023-06-04 15:07:19.574</th>
      <td>15.0</td>
    </tr>
    <tr>
      <th>2023-06-05 08:38:31.044</th>
      <td>11.5</td>
    </tr>
    <tr>
      <th>2023-06-05 19:47:28.229</th>
      <td>10.0</td>
    </tr>
    <tr>
      <th>2023-06-05 20:11:25.671</th>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2023-06-06 09:23:28.065</th>
      <td>13.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>2024-09-27 19:35:57.790</th>
      <td>20.0</td>
    </tr>
    <tr>
      <th>2024-09-27 20:09:48.635</th>
      <td>25.0</td>
    </tr>
    <tr>
      <th>2024-09-28 02:00:14.692</th>
      <td>16.0</td>
    </tr>
    <tr>
      <th>2024-09-28 05:31:45.364</th>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2024-09-28 10:16:10.065</th>
      <td>45.0</td>
    </tr>
  </tbody>
</table>
<p>3507 rows × 1 columns</p>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="visual-validation-carbohydrate-distribution">
<h1>Visual Validation: Carbohydrate Distribution<a class="headerlink" href="#visual-validation-carbohydrate-distribution" title="Link to this heading">#</a></h1>
<p>Following our carbohydrate data cleaning, we visualize the temporal distribution and magnitude of carbohydrate entries to:</p>
<ol class="arabic simple">
<li><p>Confirm removal of sub-1g entries</p></li>
<li><p>Examine the range of carbohydrate values</p></li>
<li><p>Check recording frequency and patterns</p></li>
<li><p>Identify any potential outliers requiring attention</p></li>
</ol>
<p>The scatter plot representation helps validate our minimal cleaning approach and provides insight into meal recording patterns.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make plot 25 x 12</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">carb_df</span><span class="p">[</span><span class="s1">&#39;carbs&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Carbohydrates&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span><span class="p">)</span>

<span class="c1"># Add labels, title, and legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Timestamp&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Carbohydrates&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><img alt="png" src="../_images/x_gastro_eda_27_0.png" /></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="carbohydrate-dataset-summary">
<h1>Carbohydrate Dataset Summary<a class="headerlink" href="#carbohydrate-dataset-summary" title="Link to this heading">#</a></h1>
<p>After basic cleaning, we examine the carbohydrate dataset structure and statistics to:</p>
<ol class="arabic simple">
<li><p><strong>Verify Dataset Properties</strong></p></li>
</ol>
<ul class="simple">
<li><p>Confirm single carbohydrate column retention</p></li>
<li><p>Check data type consistency</p></li>
<li><p>Review number of recorded meals</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p><strong>Statistical Distribution</strong></p></li>
</ol>
<ul class="simple">
<li><p>Typical meal carbohydrate content</p></li>
<li><p>Range of carbohydrate values</p></li>
<li><p>Help validate typical meal size assumptions</p></li>
</ul>
<p>The .info() provides structure verification while .describe() shows the statistical distribution of meal carbohydrates.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">carb_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
DatetimeIndex: 3507 entries, 2023-06-04 15:07:19.574000 to 2024-09-28 10:16:10.065000
Data columns (total 1 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   carbs   3507 non-null   float64
dtypes: float64(1)
memory usage: 54.8 KB
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">carb_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</pre></div>
</div>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carbs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>3507.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>26.377887</td>
    </tr>
    <tr>
      <th>std</th>
      <td>20.254482</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>10.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>20.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>40.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>120.000000</td>
    </tr>
  </tbody>
</table>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="blood-glucose-data-preprocessing">
<h1>Blood Glucose Data Preprocessing<a class="headerlink" href="#blood-glucose-data-preprocessing" title="Link to this heading">#</a></h1>
<p>This cleaning function prepares blood glucose data for analysis by implementing essential clinical and analytical standards:</p>
<section id="cleaning-steps">
<h2>Cleaning Steps<a class="headerlink" href="#cleaning-steps" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>Unit Standardization</strong></p></li>
</ol>
<ul class="simple">
<li><p>Renames ‘calculated_value’ to ‘mg_dl’ for clarity</p></li>
<li><p>Creates ‘mmol_l’ column (standard international units)</p></li>
<li><p>Conversion factor: mg/dL × 0.0555 = mmol/L</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p><strong>Clinical Range Enforcement</strong></p></li>
</ol>
<ul class="simple">
<li><p>Lower bound: 39.64 mg/dL (2.2 mmol/L)</p></li>
<li><p>Upper bound: 360.36 mg/dL (20.0 mmol/L)</p></li>
<li><p>Values outside range clipped to these limits</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p><strong>Data Simplification</strong></p></li>
</ol>
<ul class="simple">
<li><p>Retains only essential columns</p></li>
<li><p>Preserves timestamp index</p></li>
<li><p>Maintains dual unit representation</p></li>
</ul>
</section>
<section id="id1">
<h2>Rationale<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Range limits reflect typical CGM sensor capabilities</p></li>
<li><p>Dual units support international analysis</p></li>
<li><p>Simplified structure focuses on key metrics</p></li>
</ul>
<p><a class="reference download internal" download="" href="../_downloads/c38b3c8b3075cfca5be297423442201d/cleaning.py"><span class="xref download myst"><code class="docutils literal notranslate"><span class="pre">clean_glucose()</span></code></span></a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">glucose_df</span> <span class="o">=</span> <span class="n">clean_glucose</span><span class="p">(</span><span class="n">bg_df</span><span class="p">)</span> <span class="c1"># Function in source directory</span>
</pre></div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="blood-glucose-data-visualization">
<h1>Blood Glucose Data Visualization<a class="headerlink" href="#blood-glucose-data-visualization" title="Link to this heading">#</a></h1>
<p>We examine the glucose data through two complementary visualizations to validate our cleaning process and understand data patterns:</p>
<section id="full-dataset-scatter-plot">
<h2>Full Dataset Scatter Plot<a class="headerlink" href="#full-dataset-scatter-plot" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Shows complete temporal distribution</p></li>
<li><p>Validates clipping of extreme values</p></li>
<li><p>Reveals overall data density</p></li>
<li><p>Highlights any major gaps</p></li>
</ul>
</section>
<section id="recent-90-day-time-series">
<h2>Recent 90-Day Time Series<a class="headerlink" href="#recent-90-day-time-series" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Focused view of latest 90 days (25,920 points at 5-min intervals)</p></li>
<li><p>Connected line plot shows glucose trends</p></li>
<li><p>More detailed examination of recent monitoring</p></li>
<li><p>Better visualization of daily patterns</p></li>
</ul>
</section>
<section id="recent-48-hour-time-series">
<h2>Recent 48-Hour Time Series<a class="headerlink" href="#recent-48-hour-time-series" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Focused view of latest 48 Hours (576 points at 5-min intervals)</p></li>
<li><p>Connected line plot shows glucose trends</p></li>
<li><p>More detailed examination of recent monitoring</p></li>
<li><p>Better visualization of daily patterns
The contrast between these views helps validate both long-term data collection and recent monitoring quality.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make plot 25 x 12</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">glucose_df</span><span class="p">[</span><span class="s1">&#39;mmol_l&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;mmol/L&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span><span class="p">)</span>

<span class="c1"># Add labels, title, and legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Timestamp&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Blood Glucose (mmol/L)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><img alt="png" src="../_images/x_gastro_eda_34_0.png" /></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display most recent 90 days of glucose readings in mmol/L</span>
<span class="n">last_90</span> <span class="o">=</span> <span class="n">glucose_df</span><span class="p">[</span><span class="o">-</span><span class="mi">25920</span><span class="p">:]</span>

<span class="c1"># Make plot 25 x 12</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">last_90</span><span class="p">[</span><span class="s1">&#39;mmol_l&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;mmol/L&#39;</span><span class="p">)</span>

<span class="c1"># Add labels, title, and legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Glucose readings in mmol/L - Most recent 90 Days&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Timestamp&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Blood Glucose (mmol/L)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><img alt="png" src="../_images/x_gastro_eda_35_0.png" /></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display most recent 48 Hours of glucose readings in mmol/L</span>
<span class="n">last_48h</span> <span class="o">=</span> <span class="n">glucose_df</span><span class="p">[</span><span class="o">-</span><span class="mi">576</span><span class="p">:]</span>

<span class="c1"># Make plot 25 x 12</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">last_48h</span><span class="p">[</span><span class="s1">&#39;mmol_l&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;mmol/L&#39;</span><span class="p">)</span>

<span class="c1"># Add labels, title, and legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Glucose readings in mmol/L - Most recent 48 Hours&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Timestamp&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Blood Glucose (mmol/L)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><img alt="png" src="../_images/x_gastro_eda_36_0.png" /></p>
<p>We can see that the last 48 hour graph shows messy lines especially around 3 am, this could be due to incosistent gap sizes causing the lines to dilate and contract depending on the size of the gap. We will visualise this again after aligning our datasets to regular 5-minute intervals.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">glucose_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
DatetimeIndex: 132658 entries, 2023-06-03 22:31:05.757000 to 2024-09-28 12:00:32.280000
Data columns (total 2 columns):
 #   Column  Non-Null Count   Dtype  
---  ------  --------------   -----  
 0   mg_dl   132658 non-null  float64
 1   mmol_l  132658 non-null  float64
dtypes: float64(2)
memory usage: 7.1 MB
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">glucose_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</pre></div>
</div>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mg_dl</th>
      <th>mmol_l</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>132658.000000</td>
      <td>132658.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>118.803722</td>
      <td>6.593607</td>
    </tr>
    <tr>
      <th>std</th>
      <td>53.421262</td>
      <td>2.964880</td>
    </tr>
    <tr>
      <th>min</th>
      <td>39.640000</td>
      <td>2.200020</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>81.721612</td>
      <td>4.535549</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>110.186123</td>
      <td>6.115330</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>144.372009</td>
      <td>8.012646</td>
    </tr>
    <tr>
      <th>max</th>
      <td>360.360000</td>
      <td>19.999980</td>
    </tr>
  </tbody>
</table>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="dataset-overview-final-check">
<h1>Dataset Overview: Final Check<a class="headerlink" href="#dataset-overview-final-check" title="Link to this heading">#</a></h1>
<p>Before proceeding with dataset alignment, we perform a final verification of our three core datasets. This check ensures:</p>
<ol class="arabic simple">
<li><p><strong>Data Dimensions</strong></p></li>
</ol>
<ul class="simple">
<li><p>Number of records in each dataset</p></li>
<li><p>Column confirmations</p></li>
<li><p>Memory usage</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p><strong>Time Range Verification</strong></p></li>
</ol>
<ul class="simple">
<li><p>All datasets properly indexed by timestamp</p></li>
<li><p>Presence of complete data columns</p></li>
<li><p>No unexpected alterations from cleaning</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p><strong>Data Completeness</strong></p></li>
</ol>
<ul class="simple">
<li><p>Blood glucose monitoring frequency</p></li>
<li><p>Meal (carbohydrate) records</p></li>
<li><p>Insulin treatment entries</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">glucose_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
DatetimeIndex: 132658 entries, 2023-06-03 22:31:05.757000 to 2024-09-28 12:00:32.280000
Data columns (total 2 columns):
 #   Column  Non-Null Count   Dtype  
---  ------  --------------   -----  
 0   mg_dl   132658 non-null  float64
 1   mmol_l  132658 non-null  float64
dtypes: float64(2)
memory usage: 7.1 MB
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">carb_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
DatetimeIndex: 3507 entries, 2023-06-04 15:07:19.574000 to 2024-09-28 10:16:10.065000
Data columns (total 1 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   carbs   3507 non-null   float64
dtypes: float64(1)
memory usage: 54.8 KB
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">insulin_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
DatetimeIndex: 4595 entries, 2023-06-03 23:58:08.909000 to 2024-09-28 09:44:00.948000
Data columns (total 2 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   bolus   4595 non-null   float64
 1   basal   4595 non-null   float64
dtypes: float64(2)
memory usage: 236.7 KB
</pre></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="data-alignment-and-synthesis">
<h1>Data Alignment and Synthesis<a class="headerlink" href="#data-alignment-and-synthesis" title="Link to this heading">#</a></h1>
<p>After cleaning individual datasets, we now combine them into a unified timeframe with consistent 5-minute intervals. This critical step creates our foundation for meal impact analysis.</p>
<section id="alignment-process">
<h2>Alignment Process<a class="headerlink" href="#alignment-process" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>Timestamp Standardization</strong></p></li>
</ol>
<ul class="simple">
<li><p>Rounds all timestamps to nearest 5-minute mark</p></li>
<li><p>Creates uniform timeline across all data types</p></li>
<li><p>Spans from earliest to latest record</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p><strong>Data Integration</strong></p></li>
</ol>
<ul class="simple">
<li><p>Blood Glucose: Averaged within intervals</p></li>
<li><p>Carbohydrates: Summed within intervals</p></li>
<li><p>Insulin: Bolus and basal summed separately</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p><strong>Quality Assurance</strong></p></li>
</ol>
<ul class="simple">
<li><p>Shape verification</p></li>
<li><p>Column completeness</p></li>
<li><p>Statistical distribution check</p></li>
</ul>
<p>The resulting dataset provides:</p>
<ul class="simple">
<li><p>Complete timeline with no gaps</p></li>
<li><p>Aligned treatment and response data</p></li>
<li><p>Missing value handling appropriate to data type</p></li>
</ul>
<ul class="simple">
<li><p>Glucose: NaN preserved</p></li>
<li><p>Treatments: 0 for missing values</p></li>
</ul>
<p><a class="reference download internal" download="" href="../_downloads/29c2a059e3c9b3be1193cb1d5753024f/alignment.py"><span class="xref download myst"><code class="docutils literal notranslate"><span class="pre">align_diabetes_data()</span></code></span></a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">combined_df</span> <span class="o">=</span> <span class="n">align_diabetes_data</span><span class="p">(</span><span class="n">glucose_df</span><span class="p">,</span> <span class="n">carb_df</span><span class="p">,</span> <span class="n">insulin_df</span><span class="p">)</span> <span class="c1"># Function in source directory</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">combined_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>(138979, 5)
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">combined_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
DatetimeIndex: 138979 entries, 2023-06-03 22:30:00 to 2024-09-28 12:00:00
Freq: 5min
Data columns (total 5 columns):
 #   Column  Non-Null Count   Dtype  
---  ------  --------------   -----  
 0   mg_dl   132404 non-null  float64
 1   mmol_l  132404 non-null  float64
 2   carbs   138979 non-null  float64
 3   bolus   138979 non-null  float64
 4   basal   138979 non-null  float64
dtypes: float64(5)
memory usage: 6.4 MB
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">combined_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</pre></div>
</div>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mg_dl</th>
      <th>mmol_l</th>
      <th>carbs</th>
      <th>bolus</th>
      <th>basal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>132404.000000</td>
      <td>132404.000000</td>
      <td>138979.000000</td>
      <td>138979.000000</td>
      <td>138979.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>118.818741</td>
      <td>6.594440</td>
      <td>0.665620</td>
      <td>0.106231</td>
      <td>0.039092</td>
    </tr>
    <tr>
      <th>std</th>
      <td>53.428713</td>
      <td>2.965294</td>
      <td>5.257466</td>
      <td>0.710322</td>
      <td>0.679371</td>
    </tr>
    <tr>
      <th>min</th>
      <td>39.640000</td>
      <td>2.200020</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>81.736647</td>
      <td>4.536384</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>110.189776</td>
      <td>6.115533</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>144.369838</td>
      <td>8.012526</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>360.360000</td>
      <td>19.999980</td>
      <td>140.000000</td>
      <td>16.000000</td>
      <td>15.000000</td>
    </tr>
  </tbody>
</table>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="glucose-data-gap-analysis">
<h1>Glucose Data Gap Analysis<a class="headerlink" href="#glucose-data-gap-analysis" title="Link to this heading">#</a></h1>
<p>After alignment, we analyze the continuity of glucose monitoring data to identify and characterize monitoring gaps. This analysis is crucial for:</p>
<section id="gap-detection-process">
<h2>Gap Detection Process<a class="headerlink" href="#gap-detection-process" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>Identification</strong></p></li>
</ol>
<ul class="simple">
<li><p>Finds sequences of missing glucose values</p></li>
<li><p>Records start and end times</p></li>
<li><p>Calculates gap durations</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p><strong>Classification</strong></p></li>
</ol>
<ul class="simple">
<li><p>Stores gap information in structured format</p></li>
<li><p>Identifies longest gaps</p></li>
<li><p>Creates human-readable duration format</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p><strong>Meal Impact Analysis</strong></p></li>
</ol>
<ul class="simple">
<li><p>Checks for meals preceding gaps</p></li>
<li><p>Flags gaps that might affect meal analysis</p></li>
<li><p>4-hour pre-gap meal window check</p></li>
</ul>
</section>
<section id="key-outputs">
<h2>Key Outputs<a class="headerlink" href="#key-outputs" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Top N largest gaps with detailed timing</p></li>
<li><p>Total number of gaps</p></li>
<li><p>Complete gap inventory</p></li>
<li><p>Meal proximity warnings</p></li>
</ul>
<p><a class="reference download internal" download="" href="../_downloads/4f69e8c694db9aa3d9467381b458c01f/gaps.py"><span class="xref download myst"><code class="docutils literal notranslate"><span class="pre">analyse_glucose_gaps()</span></code></span></a>
<a class="reference download internal" download="" href="../_downloads/60c5fc292ced0c0ff2184189200bcb57/gap_dashboard.py"><span class="xref download myst"><code class="docutils literal notranslate"><span class="pre">create_gap_dashboard()</span></code></span></a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">gap_analysis</span> <span class="o">=</span> <span class="n">analyse_glucose_gaps</span><span class="p">(</span><span class="n">combined_df</span><span class="p">)</span> <span class="c1"># Function in source directory</span>

<span class="c1"># Create and display data quality display dashboard</span>
<span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;img/gap_dashboard.png&#39;</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">create_gap_dashboard</span><span class="p">(</span><span class="n">gap_analysis</span><span class="p">,</span> <span class="n">save_path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span> <span class="c1"># Function in source directory</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Gaps Dashboard saved.
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pprint</span><span class="o">.</span><span class="n">pp</span><span class="p">(</span><span class="n">gap_analysis</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;total_gaps&#39;: 5743,
 &#39;largest_gaps&#39;:               start_time            end_time  length_minutes duration
1973 2023-12-20 14:50:00 2023-12-22 07:05:00          2415.0  40h 15m
506  2023-07-29 17:50:00 2023-07-30 04:45:00           655.0  10h 55m
4725 2024-07-27 06:15:00 2024-07-27 10:25:00           250.0   4h 10m
3855 2024-05-25 13:40:00 2024-05-25 15:35:00           115.0   1h 55m
723  2023-08-23 16:35:00 2023-08-23 17:35:00            60.0    1h 0m
3303 2024-04-06 15:25:00 2024-04-06 16:15:00            50.0   0h 50m
1037 2023-09-19 06:35:00 2023-09-19 07:20:00            45.0   0h 45m
2795 2024-02-20 15:25:00 2024-02-20 16:10:00            45.0   0h 45m
4523 2024-07-12 00:45:00 2024-07-12 01:25:00            40.0   0h 40m
3591 2024-05-01 01:55:00 2024-05-01 02:35:00            40.0   0h 40m,
 &#39;gaps_df&#39;:               start_time            end_time  length_minutes
0    2023-06-03 22:45:00 2023-06-03 22:50:00             5.0
1    2023-06-04 04:50:00 2023-06-04 04:55:00             5.0
2    2023-06-04 05:40:00 2023-06-04 05:45:00             5.0
3    2023-06-04 07:40:00 2023-06-04 07:45:00             5.0
4    2023-06-04 08:50:00 2023-06-04 08:55:00             5.0
...                  ...                 ...             ...
5738 2024-09-28 09:35:00 2024-09-28 09:40:00             5.0
5739 2024-09-28 09:55:00 2024-09-28 10:00:00             5.0
5740 2024-09-28 10:25:00 2024-09-28 10:30:00             5.0
5741 2024-09-28 10:50:00 2024-09-28 10:55:00             5.0
5742 2024-09-28 11:40:00 2024-09-28 11:45:00             5.0

[5743 rows x 3 columns]}
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display created dashboard</span>
<span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">path</span><span class="p">))</span>
</pre></div>
</div>
<p><img alt="png" src="../_images/x_gastro_eda_52_0.png" /></p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="glucose-monitoring-gap-analysis-results">
<h1>Glucose Monitoring Gap Analysis Results<a class="headerlink" href="#glucose-monitoring-gap-analysis-results" title="Link to this heading">#</a></h1>
<section id="overview-of-data-gaps">
<h2>Overview of Data Gaps<a class="headerlink" href="#overview-of-data-gaps" title="Link to this heading">#</a></h2>
<p>Our analysis identified 5,743 total gaps in glucose monitoring, with durations ranging from 5 minutes to over 40 hours. This comprehensive gap analysis reveals several key patterns:</p>
</section>
<section id="gap-distribution">
<h2>Gap Distribution<a class="headerlink" href="#gap-distribution" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>Major Gaps</strong> (&gt;4 hours):</p></li>
</ol>
<ul class="simple">
<li><p>One exceptional gap of 40h 15m (Dec 20-22, 2023)</p></li>
<li><p>One significant gap of 10h 55m (July 29-30, 2023)</p></li>
<li><p>One moderate gap of 4h 10m (July 27, 2024)</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p><strong>Medium Gaps</strong> (1-4 hours):</p></li>
</ol>
<ul class="simple">
<li><p>Only two gaps in this range</p></li>
<li><p>Maximum of 1h 55m (May 25, 2024)</p></li>
<li><p>Minimum of 1h (Aug 23, 2023)</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p><strong>Minor Gaps</strong> (&lt;1 hour):</p></li>
</ol>
<ul class="simple">
<li><p>Most common duration: 5 minutes</p></li>
<li><p>Several gaps between 40-50 minutes</p></li>
<li><p>Generally well-distributed across the monitoring period</p></li>
</ul>
</section>
<section id="critical-observations">
<h2>Critical Observations<a class="headerlink" href="#critical-observations" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>Meal Impact</strong></p></li>
</ol>
<ul class="simple">
<li><p>5 of the top 10 gaps have meals in the preceding 4 hours</p></li>
<li><p>Most concerning for the 4h+ gaps affecting post-meal analysis</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p><strong>Data Quality</strong></p></li>
</ol>
<ul class="simple">
<li><p>Majority of gaps (&gt;5,000) are brief 5-minute interruptions</p></li>
<li><p>Only 3 gaps exceed typical meal analysis window (4 hours)</p></li>
<li><p>Overall excellent data continuity with few significant interruptions</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p><strong>Monitoring Patterns</strong></p></li>
</ol>
<ul class="simple">
<li><p>No seasonal pattern in major gaps</p></li>
<li><p>Even distribution of minor gaps suggests routine sensor changes</p></li>
<li><p>Good recovery after interruptions</p></li>
</ul>
<p>This analysis supports our decision to proceed with meal impact analysis, as the vast majority of gaps are brief and manageable with our chosen interpolation approach.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="meal-analysis-configuration-and-quality-assessment">
<h1>Meal Analysis Configuration and Quality Assessment<a class="headerlink" href="#meal-analysis-configuration-and-quality-assessment" title="Link to this heading">#</a></h1>
<section id="data-quality-framework">
<h2>Data Quality Framework<a class="headerlink" href="#data-quality-framework" title="Link to this heading">#</a></h2>
<p>We implement a structured approach for assessing meal data quality and handling glucose data gaps, with clear classification criteria and configurable parameters.</p>
</section>
<section id="quality-categories">
<h2>Quality Categories<a class="headerlink" href="#quality-categories" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>Clean Meals</strong></p>
<ul class="simple">
<li><p>Perfect data quality</p></li>
<li><p>No gaps in glucose readings</p></li>
<li><p>Ideal for analysis</p></li>
</ul>
</li>
<li><p><strong>Usable Meals</strong></p>
<ul class="simple">
<li><p>Small gaps (≤15 minutes)</p></li>
<li><p>Missing data ≤10%</p></li>
<li><p>Suitable for analysis after interpolation</p></li>
</ul>
</li>
<li><p><strong>Borderline Meals</strong></p>
<ul class="simple">
<li><p>Medium gaps (≤25 minutes)</p></li>
<li><p>Missing data ≤20%</p></li>
<li><p>Use with caution</p></li>
</ul>
</li>
<li><p><strong>Unusable Meals</strong></p>
<ul class="simple">
<li><p>Large gaps (&gt;25 minutes)</p></li>
<li><p>Missing data &gt;20%</p></li>
<li><p>Exclude from analysis</p></li>
</ul>
</li>
</ol>
</section>
<section id="configuration-parameters">
<h2>Configuration Parameters<a class="headerlink" href="#configuration-parameters" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Minimum meal size: 20g carbohydrates</p></li>
<li><p>Post-meal analysis window: 4 hours</p></li>
<li><p>Maximum interpolation: 5 consecutive readings (25 minutes)</p></li>
<li><p>Clear thresholds for gap classification</p></li>
<li><p>Configurable quality criteria</p></li>
</ul>
</section>
<section id="processing-workflow">
<h2>Processing Workflow<a class="headerlink" href="#processing-workflow" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Gap Analysis</p>
<ul class="simple">
<li><p>Identifies missing data patterns</p></li>
<li><p>Calculates gap durations</p></li>
<li><p>Determines data completeness</p></li>
</ul>
</li>
<li><p>Quality Assessment</p>
<ul class="simple">
<li><p>Evaluates each meal period</p></li>
<li><p>Assigns quality categories</p></li>
<li><p>Marks meals for inclusion/exclusion</p></li>
</ul>
</li>
<li><p>Data Enhancement</p>
<ul class="simple">
<li><p>Interpolates acceptable gaps</p></li>
<li><p>Marks interpolated values</p></li>
<li><p>Preserves data integrity</p></li>
</ul>
</li>
</ol>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="meal-quality-statistics-generation">
<h1>Meal Quality Statistics Generation<a class="headerlink" href="#meal-quality-statistics-generation" title="Link to this heading">#</a></h1>
<p>This function computes comprehensive statistics about our meal dataset quality, providing key metrics for assessing data reliability and processing effectiveness.</p>
<section id="generated-statistics">
<h2>Generated Statistics<a class="headerlink" href="#generated-statistics" title="Link to this heading">#</a></h2>
<p>The function calculates essential metrics across several dimensions:</p>
<ol class="arabic simple">
<li><p><strong>Volume Metrics</strong></p></li>
</ol>
<ul class="simple">
<li><p>Total number of meals (&gt;20g carbs)</p></li>
<li><p>Counts per quality category</p></li>
<li><p>Percentage distribution across categories</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p><strong>Quality Indicators</strong></p></li>
</ol>
<ul class="simple">
<li><p>Average percentage of missing data</p></li>
<li><p>Average gap duration</p></li>
<li><p>Proportion of usable meals</p></li>
<li><p>Number and percentage of interpolated points</p></li>
</ul>
</section>
<section id="statistical-output-format">
<h2>Statistical Output Format<a class="headerlink" href="#statistical-output-format" title="Link to this heading">#</a></h2>
<p>Returns a dictionary containing:</p>
<ul class="simple">
<li><p>Raw counts and percentages</p></li>
<li><p>Data completeness metrics</p></li>
<li><p>Interpolation impact measures</p></li>
<li><p>All metrics aligned with MealAnalysisConfig parameters</p></li>
</ul>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="meal-quality-dashboard-generation">
<h1>Meal Quality Dashboard Generation<a class="headerlink" href="#meal-quality-dashboard-generation" title="Link to this heading">#</a></h1>
<p><a class="reference download internal" download="" href="../_downloads/0239a48d3da1c84462c8d7825b7794fc/meals.py"><span class="xref download myst"><code class="docutils literal notranslate"><span class="pre">analyse_meal_data()</span></code></span></a>
<a class="reference download internal" download="" href="../_downloads/0239a48d3da1c84462c8d7825b7794fc/meals.py"><span class="xref download myst"><code class="docutils literal notranslate"><span class="pre">get_meal_statistics()</span></code></span></a>
<a class="reference download internal" download="" href="../_downloads/18c407be73b466ecc7300590fba38ab6/meal_statistics_dashboard.py"><span class="xref download myst"><code class="docutils literal notranslate"><span class="pre">create_meal_statistics_dashboard()</span></code></span></a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">analysed_df</span> <span class="o">=</span> <span class="n">analyse_meal_data</span><span class="p">(</span><span class="n">combined_df</span><span class="p">)</span> <span class="c1"># Run meal quality analysis - Function in src directory</span>

<span class="n">stats</span> <span class="o">=</span> <span class="n">get_meal_statistics</span><span class="p">(</span><span class="n">analysed_df</span><span class="p">)</span>     <span class="c1"># Create analysis statistics - Function in src directory</span>

<span class="c1"># Create and display data quality display dashboard</span>
<span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;img/meal_statistics_dashboard.png&#39;</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">create_meal_statistics_dashboard</span><span class="p">(</span><span class="n">stats</span><span class="p">,</span> <span class="n">save_path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span> <span class="c1"># Create meal statistics dashboard - Function in src directory</span>

<span class="n">pprint</span><span class="o">.</span><span class="n">pp</span><span class="p">(</span><span class="n">stats</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Meal Statistics Dashboard saved.
{&#39;total_meals&#39;: 1628,
 &#39;quality_counts&#39;: {&#39;Usable&#39;: 1309,
                    &#39;Clean&#39;: 170,
                    &#39;Borderline&#39;: 137,
                    &#39;Unusable&#39;: 12},
 &#39;quality_percentages&#39;: {&#39;Usable&#39;: 80.4054054054054,
                         &#39;Clean&#39;: 10.442260442260443,
                         &#39;Borderline&#39;: 8.415233415233416,
                         &#39;Unusable&#39;: 0.7371007371007371},
 &#39;avg_missing_pct&#39;: np.float64(4.550468836183122),
 &#39;avg_gap_duration&#39;: np.float64(4.895577395577396),
 &#39;usable_meals_pct&#39;: 99.26289926289927,
 &#39;interpolated_points&#39;: np.int64(1808),
 &#39;interpolated_pct&#39;: np.float64(1.3009159657214397)}
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display created dashboard</span>
<span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">path</span><span class="p">))</span>
</pre></div>
</div>
<p><img alt="png" src="../_images/x_gastro_eda_57_0.png" /></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="meal-analysis-results-summary">
<h1>Meal Analysis Results Summary<a class="headerlink" href="#meal-analysis-results-summary" title="Link to this heading">#</a></h1>
<section id="dataset-overview">
<h2>Dataset Overview<a class="headerlink" href="#dataset-overview" title="Link to this heading">#</a></h2>
<p>Analysis of 1,628 meals (&gt;20g carbs) reveals excellent data quality with high usability for gastroparesis screening:</p>
</section>
<section id="quality-distribution">
<h2>Quality Distribution<a class="headerlink" href="#quality-distribution" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Clean Meals</strong>: 170 (10.44%)</p></li>
</ul>
<ul class="simple">
<li><p>Perfect data quality</p></li>
<li><p>No interpolation needed</p></li>
</ul>
<ul class="simple">
<li><p><strong>Usable Meals</strong>: 1,309 (80.41%)</p></li>
</ul>
<ul class="simple">
<li><p>Primary analysis dataset</p></li>
<li><p>Minor gaps successfully interpolated</p></li>
</ul>
<ul class="simple">
<li><p><strong>Borderline Meals</strong>: 137 (8.42%)</p></li>
</ul>
<ul class="simple">
<li><p>Usable with caution</p></li>
<li><p>Higher but acceptable gap rates</p></li>
</ul>
<ul class="simple">
<li><p><strong>Unusable Meals</strong>: 12 (0.74%)</p></li>
</ul>
<ul class="simple">
<li><p>Excluded from analysis</p></li>
<li><p>Excessive missing data</p></li>
</ul>
</section>
<section id="data-quality-metrics">
<h2>Data Quality Metrics<a class="headerlink" href="#data-quality-metrics" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>Gap Characteristics</strong></p></li>
</ol>
<ul class="simple">
<li><p>Average gap duration: 4.90 minutes</p></li>
<li><p>Average missing data: 4.55%</p></li>
<li><p>Both well within acceptable limits</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p><strong>Interpolation Impact</strong></p></li>
</ol>
<ul class="simple">
<li><p>1,808 points interpolated</p></li>
<li><p>Only 1.30% of total readings</p></li>
<li><p>Minimal data manipulation required</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p><strong>Overall Usability</strong></p></li>
</ol>
<ul class="simple">
<li><p>99.26% of meals usable for analysis</p></li>
<li><p>Strong foundation for gastroparesis screening</p></li>
<li><p>High confidence in data integrity</p></li>
</ul>
<p>These results indicate exceptional data quality with minimal need for interpolation, providing a robust dataset for subsequent analysis.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="dataset-structure-and-statistical-summary">
<h1>Dataset Structure and Statistical Summary<a class="headerlink" href="#dataset-structure-and-statistical-summary" title="Link to this heading">#</a></h1>
<section id="dataset-properties-analysis">
<h2>Dataset Properties Analysis<a class="headerlink" href="#dataset-properties-analysis" title="Link to this heading">#</a></h2>
<p>After meal quality analysis and interpolation, let’s examine our complete dataset structure and statistical distribution.</p>
</section>
<section id="data-structure">
<h2>Data Structure<a class="headerlink" href="#data-structure" title="Link to this heading">#</a></h2>
<p>Let’s examine:</p>
<ol class="arabic simple">
<li><p>Total records and memory usage</p></li>
<li><p>Column data types</p></li>
<li><p>Non-null counts</p></li>
<li><p>Index structure and timeline coverage</p></li>
</ol>
</section>
<section id="statistical-distribution">
<h2>Statistical Distribution<a class="headerlink" href="#statistical-distribution" title="Link to this heading">#</a></h2>
<p>The describe() output provides key statistics for each column:</p>
<ol class="arabic simple">
<li><p>Central tendency (mean, std)</p></li>
<li><p>Range and quartiles</p></li>
<li><p>Treatment frequency and size</p></li>
<li><p>Glucose value distribution</p></li>
</ol>
<p>This verification ensures our processing maintained data integrity while improving usability.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">analysed_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
DatetimeIndex: 138979 entries, 2023-06-03 22:30:00 to 2024-09-28 12:00:00
Freq: 5min
Data columns (total 11 columns):
 #   Column             Non-Null Count   Dtype  
---  ------             --------------   -----  
 0   mg_dl              134925 non-null  float64
 1   mmol_l             134925 non-null  float64
 2   carbs              138979 non-null  float64
 3   bolus              138979 non-null  float64
 4   basal              138979 non-null  float64
 5   has_missing_data   138979 non-null  bool   
 6   gap_duration_mins  138979 non-null  float64
 7   missing_pct        138979 non-null  float64
 8   meal_quality       1628 non-null    object 
 9   skip_meal          138979 non-null  bool   
 10  interpolated       138979 non-null  bool   
dtypes: bool(3), float64(7), object(1)
memory usage: 14.0+ MB
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">analysed_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</pre></div>
</div>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mg_dl</th>
      <th>mmol_l</th>
      <th>carbs</th>
      <th>bolus</th>
      <th>basal</th>
      <th>gap_duration_mins</th>
      <th>missing_pct</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>134925.000000</td>
      <td>134925.000000</td>
      <td>138979.000000</td>
      <td>138979.000000</td>
      <td>138979.000000</td>
      <td>138979.000000</td>
      <td>138979.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>118.761766</td>
      <td>6.591278</td>
      <td>0.665620</td>
      <td>0.106231</td>
      <td>0.039092</td>
      <td>0.057347</td>
      <td>0.053304</td>
    </tr>
    <tr>
      <th>std</th>
      <td>53.405889</td>
      <td>2.964027</td>
      <td>5.257466</td>
      <td>0.710322</td>
      <td>0.679371</td>
      <td>0.808486</td>
      <td>0.683813</td>
    </tr>
    <tr>
      <th>min</th>
      <td>39.640000</td>
      <td>2.200020</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>81.687730</td>
      <td>4.533669</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>110.187646</td>
      <td>6.115414</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>144.341367</td>
      <td>8.010946</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>360.360000</td>
      <td>19.999980</td>
      <td>140.000000</td>
      <td>16.000000</td>
      <td>15.000000</td>
      <td>125.000000</td>
      <td>73.469388</td>
    </tr>
  </tbody>
</table>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="diabetes-data-processing-and-meal-analysis-summary">
<h1>Diabetes Data Processing and Meal Analysis Summary<a class="headerlink" href="#diabetes-data-processing-and-meal-analysis-summary" title="Link to this heading">#</a></h1>
<section id="initial-data-processing">
<h2>Initial Data Processing<a class="headerlink" href="#initial-data-processing" title="Link to this heading">#</a></h2>
<p>We started with three separate dataframes extracted from xDrip+ CGM management software:</p>
<ul class="simple">
<li><p>Blood glucose readings (mg/dl and mmol/l) at approximately 5-minute intervals</p></li>
<li><p>Carbohydrate intake records</p></li>
<li><p>Insulin (bolus and basal) records processed from treatment logs</p></li>
</ul>
</section>
<section id="data-alignment-and-quality-analysis">
<h2>Data Alignment and Quality Analysis<a class="headerlink" href="#data-alignment-and-quality-analysis" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Aligned all data to regular 5-minute intervals</p></li>
<li><p>Created a meal analysis framework with configurable parameters:</p></li>
</ol>
<ul class="simple">
<li><p>4-hour post-meal analysis windows</p></li>
<li><p>Minimum 20g carbs to consider as significant meal</p></li>
<li><p>Maximum gap tolerance of 25 minutes</p></li>
<li><p>Maximum 20% missing data allowed</p></li>
<li><p>Interpolation limit of 25 minutes (5 readings)</p></li>
</ul>
</section>
<section id="quality-metrics-and-results">
<h2>Quality Metrics and Results<a class="headerlink" href="#quality-metrics-and-results" title="Link to this heading">#</a></h2>
<p>Our analysis of 1,628 significant meals (&gt;20g carbs) shows:</p>
<ul class="simple">
<li><p>170 Clean meals (10.44%): Perfect data, no gaps</p></li>
<li><p>1,309 Usable meals (80.41%): Small gaps only, ≤10% missing</p></li>
<li><p>137 Borderline meals (8.42%): Medium gaps, ≤20% missing</p></li>
<li><p>Only 12 Unusable meals (0.74%): Large gaps or excessive missing data</p></li>
</ul>
<p>The data quality is excellent:</p>
<ul class="simple">
<li><p>99.26% of meals are usable for analysis</p></li>
<li><p>Average missing data is only 4.55%</p></li>
<li><p>Average gap duration is 4.90 minutes</p></li>
<li><p>Only 1.30% of points needed interpolation (1,808 points)</p></li>
</ul>
</section>
<section id="new-dataset-features">
<h2>New Dataset Features<a class="headerlink" href="#new-dataset-features" title="Link to this heading">#</a></h2>
<p>The processed dataframe includes additional columns crucial for gastroparesis screening:</p>
<ul class="simple">
<li><p>has_missing_data: Flags any missing BG in 4h post-meal, crucial for response curve integrity</p></li>
<li><p>gap_duration_mins: Longest gap in post-meal period, important for meal absorption analysis</p></li>
<li><p>missing_pct: Percentage of missing readings, validates data quality</p></li>
<li><p>meal_quality: Clean/Usable/Borderline/Unusable, enables filtered analysis</p></li>
<li><p>skip_meal: Boolean for excluding from analysis, maintains data quality standards</p></li>
<li><p>interpolated: Marks interpolated values, ensures transparency in analysis</p></li>
</ul>
</section>
<section id="important-notes">
<h2>Important Notes<a class="headerlink" href="#important-notes" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>All original data is preserved - no rows have been removed</p></li>
<li><p>Small gaps have been interpolated where appropriate</p></li>
<li><p>Quality markers allow easy filtering for analysis</p></li>
<li><p>20g carbohydrate threshold ensures significant meal impacts</p></li>
<li><p>Data structure supports comprehensive meal response analysis</p></li>
</ol>
</section>
<section id="next-steps">
<h2>Next Steps<a class="headerlink" href="#next-steps" title="Link to this heading">#</a></h2>
<p>While the data is now well-organized and quality-assessed, specific gastroparesis analysis may require:</p>
<ul class="simple">
<li><p>Meal size stratification analysis (varying carbohydrate loads)</p></li>
<li><p>Time-of-day impact assessment on gastric emptying</p></li>
<li><p>Insulin timing relationship with meal absorption</p></li>
<li><p>Sensor type and calibration effects on readings</p></li>
<li><p>Additional meal characteristic analysis</p></li>
<li><p>Specific time window selections for different meal types</p></li>
<li><p>Additional derived features for absorption patterns</p></li>
<li><p>Custom filtering based on research requirements</p></li>
</ul>
<p>This processed dataset provides a robust foundation for investigating gastric motility patterns through post-meal glucose responses.</p>
<p><a class="reference download internal" download="" href="../_downloads/8f34a1cf3cc504ca334479e4e05f7c62/metrics.py"><span class="xref download myst"><code class="docutils literal notranslate"><span class="pre">display_quality_metrics()</span></code></span></a>
<a class="reference download internal" download="" href="../_downloads/b8c82fc84c0eff2586d72db2bb13b4ca/quality_dashboard.py"><span class="xref download myst"><code class="docutils literal notranslate"><span class="pre">creatte_quality_dashboard()</span></code></span></a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display detailed metrics</span>
<span class="n">metrics</span> <span class="o">=</span> <span class="n">display_quality_metrics</span><span class="p">(</span><span class="n">analysed_df</span><span class="p">)</span> <span class="c1"># Function can be found in src directory</span>
<span class="n">metrics</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;total_readings&#39;: 138979,
 &#39;complete_readings&#39;: np.int64(134925),
 &#39;completeness_rate&#39;: np.float64(97.08301254146309),
 &#39;interpolated_points&#39;: np.int64(1808),
 &#39;interpolation_rate&#39;: np.float64(1.3009159657214397),
 &#39;average_gap_duration&#39;: np.float64(0.05734679340044179),
 &#39;max_gap_duration&#39;: np.float64(125.0),
 &#39;total_meals&#39;: 1628,
 &#39;meal_quality_distribution&#39;: {&#39;Usable&#39;: 1309,
  &#39;Clean&#39;: 170,
  &#39;Borderline&#39;: 137,
  &#39;Unusable&#39;: 12}}
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create and display data quality display dashboard</span>
<span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;img/output_dashboard.png&#39;</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">create_quality_dashboard</span><span class="p">(</span><span class="n">analysed_df</span><span class="p">,</span> <span class="n">save_path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>

<span class="c1"># Display created dashboard</span>
<span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">path</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Data Quality Dashboard saved
</pre></div>
</div>
<p><img alt="png" src="../_images/x_gastro_eda_64_1.png" /></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Save dataframe to CSV file for future use</span>
<span class="n">analysed_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;../../data/processed_data.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Welcome to My Jupyter Book!</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">xDrip+ Data Analysis for Gastroparesis Screening (XGastro-EDA)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#project-context">Project Context</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-source">Data Source</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#project-objectives">Project Objectives</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#notebook-structure">Notebook Structure</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#required-libraries-and-dependencies">Required Libraries and Dependencies</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#import-our-created-functions">Import our created functions</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-source-xdrip-sqlite-database">Data Source: xDrip+ SQLite Database</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#database-connection">Database Connection</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-and-initial-data-processing">Loading and Initial Data Processing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-loading-process">Data Loading Process</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#treatment-data-preprocessing-insulin-classification">Treatment Data Preprocessing: Insulin Classification</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#classification-rules">Classification Rules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#function-process">Function Process</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#analysing-insulin-usage-patterns-over-time">Analysing Insulin Usage Patterns Over Time</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-components">Analysis Components</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualisation">Visualisation</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-validation-raw-insulin-distribution">Data Validation: Raw Insulin Distribution</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#refined-insulin-dataset-structure">Refined Insulin Dataset Structure</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#carbohydrate-data-preprocessing">Carbohydrate Data Preprocessing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rationale">Rationale</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#refined-carbohydrate-dataset-structure">Refined Carbohydrate Dataset Structure</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#visual-validation-carbohydrate-distribution">Visual Validation: Carbohydrate Distribution</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#carbohydrate-dataset-summary">Carbohydrate Dataset Summary</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#blood-glucose-data-preprocessing">Blood Glucose Data Preprocessing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cleaning-steps">Cleaning Steps</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Rationale</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#blood-glucose-data-visualization">Blood Glucose Data Visualization</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#full-dataset-scatter-plot">Full Dataset Scatter Plot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recent-90-day-time-series">Recent 90-Day Time Series</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recent-48-hour-time-series">Recent 48-Hour Time Series</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-overview-final-check">Dataset Overview: Final Check</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-alignment-and-synthesis">Data Alignment and Synthesis</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alignment-process">Alignment Process</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#glucose-data-gap-analysis">Glucose Data Gap Analysis</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gap-detection-process">Gap Detection Process</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#key-outputs">Key Outputs</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#glucose-monitoring-gap-analysis-results">Glucose Monitoring Gap Analysis Results</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview-of-data-gaps">Overview of Data Gaps</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gap-distribution">Gap Distribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#critical-observations">Critical Observations</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#meal-analysis-configuration-and-quality-assessment">Meal Analysis Configuration and Quality Assessment</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-quality-framework">Data Quality Framework</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-categories">Quality Categories</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration-parameters">Configuration Parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#processing-workflow">Processing Workflow</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#meal-quality-statistics-generation">Meal Quality Statistics Generation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generated-statistics">Generated Statistics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-output-format">Statistical Output Format</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#meal-quality-dashboard-generation">Meal Quality Dashboard Generation</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#meal-analysis-results-summary">Meal Analysis Results Summary</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-overview">Dataset Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-distribution">Quality Distribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-quality-metrics">Data Quality Metrics</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-structure-and-statistical-summary">Dataset Structure and Statistical Summary</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-properties-analysis">Dataset Properties Analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-structure">Data Structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-distribution">Statistical Distribution</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#diabetes-data-processing-and-meal-analysis-summary">Diabetes Data Processing and Meal Analysis Summary</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-data-processing">Initial Data Processing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-alignment-and-quality-analysis">Data Alignment and Quality Analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-metrics-and-results">Quality Metrics and Results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#new-dataset-features">New Dataset Features</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#important-notes">Important Notes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#next-steps">Next Steps</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Warren Bebbington
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>